
# iCheMA

This repository contains the Matlab implementation of iCheMA with adaptation to the Biopepa data set, which includes mRNA and gradient measurements from a stochastic process simulating transcriptional regulation. iCheMA was described in detail here: 

       Aderhold, A., Grzegorczyk, M., and Husmeier, D. (2016). Approximate Bayesian inference in semi-mechanistic models. Statistics and Computing, 1-38.

iCheMA is a modified variant of CheMA introduced in 

Oates, C.J., Dondelinger, F., Bayani, N., Korkola, J., Gray, J.W.,
Mukherjee, S.: Causal network inference using biochemical kinetics.
Bioinformatics 30(17), i468¡Vi474 (2014)


* Overview

This folder contains two scripts: run_ICHEMA.m and evaluate_Results.m. The results that are generated by both are saved into the subdirectory 'Results'. The remaining scripts are in the subdirectory 'Scripts'. The directory 'Data' contains the concentration and gradient data. In this case, it is the example Biopepa data that is also used in the first mentioned paper. 


* Usage

1. execute run_ICHEMA.m

This script runs iCheMA on several network and instances of the Biopepa data. The Biopepa data requires a couple of special preprocessing steps, which are implemented in load_Data(). Modify this function and the parameters related to reading in the data. Another important issue is the parent set configuration. The function getParentSets() build the parent and activator/inhibitor combinations given a maximal fan-in. Furthermore, the number of available predictor variables influences the amount of parent sets, which has to be taken into account when modifying the code for new data (see getParentSets()).

Important: Running iCheMA even on a single data set can take some time depending on the number of MCMC iterations. 

2.  execute evalute_Results.m

The script will read in the previously calculated marginal log likelihoods of all the parent set configurations and corresponding activation and inhibition term setups. It will produce a posterior probability score for each response and predictor variable given these scores. Finally, if the gold standard is known, as it is the case for the Biopepa data, the area under the ROC curve (AUROC) and the area under the PREC curve are calculated. These values are stored in the directory 'Results/EVAL'. 

Modify this script according to your needs. 
     
